<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Facture - Commande #CMD-{{ commandes[0].id }}-{{ commandes[0].dateCreation|date('Ymd') }}</title>
    <style>
        :root {
            --primary-color: #d62b2b;
            --primary-dark: #a71c1c;
            --secondary-color: #2b2d42;
            --accent-color: #f8d7da;
            --light-color: #fff9f9;
            --dark-color: #2b2d42;
            --text-light: #ffffff;
            --text-dark: #2b2d42;
            --border-radius: 8px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Helvetica', Arial, sans-serif;
            color: var(--text-dark);
            line-height: 1.5;
            font-size: 12pt;
        }
        
        .container {
            max-width: 100%;
            padding: 1.5cm;
        }
        
        /* Header */
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--primary-color);
        }
        
        .order-title {
            font-size: 1.8rem;
            color: var(--primary-dark);
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        
        /* Order Info */
        .order-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .info-card {
            padding: 0.8rem;
        }
        
        .info-card h3 {
            font-size: 0.9rem;
            color: var(--primary-dark);
            margin-bottom: 0.5rem;
        }
        
        .info-card p {
            font-size: 1rem;
            font-weight: 600;
        }
        
        /* Products Table */
        .products-container {
            margin-bottom: 1.5rem;
        }
        
        .products-header {
            background-color: var(--primary-dark);
            color: white;
            padding: 0.8rem 1rem;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        
        .products-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }
        
        .products-table th {
            padding: 0.8rem;
            text-align: left;
            font-weight: 600;
            color: var(--primary-dark);
            border-bottom: 2px solid var(--accent-color);
            background-color: var(--light-color);
        }
        
        .products-table td {
            padding: 0.8rem;
            border-bottom: 1px solid var(--accent-color);
            vertical-align: top;
        }
        
        .product-info {
            display: flex;
            align-items: center;
        }
        
        .product-img {
            width: 60px;
            height: 60px;
            border-radius: 4px;
            object-fit: cover;
            margin-right: 1rem;
            border: 1px solid #eee;
        }
        
        .product-name {
            font-weight: 700;
            margin-bottom: 0.3rem;
        }
        
        .product-sku {
            font-size: 0.8rem;
            color: #666;
        }
        
        .quantity-badge {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            background: var(--accent-color);
            border-radius: 4px;
            font-weight: 700;
            color: var(--primary-dark);
        }
        
        /* Order Summary */
        .order-summary {
            margin-top: 1.5rem;
            padding: 1rem;
            border-top: 2px solid var(--primary-color);
        }
        
        .summary-title {
            font-size: 1.3rem;
            color: var(--primary-dark);
            margin-bottom: 1rem;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
        }
        
        .summary-row:last-child {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--primary-dark);
            margin-top: 0.5rem;
            padding-top: 0.5rem;
            border-top: 1px solid var(--accent-color);
        }
        
        /* Footer */
        .invoice-footer {
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #ddd;
            font-size: 0.9rem;
            text-align: center;
            color: #666;
        }
        
        /* Print-specific styles */
        @page {
            margin: 1cm;
            size: A4 portrait;
        }
        
        @media print {
            body {
                font-size: 11pt;
            }
            
            .container {
                padding: 0;
            }
            
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header with logo and invoice info -->
        <div class="order-header">
            <div>
                <h1 class="order-title">Facture</h1>
                <p>N° CMD-{{ commandes[0].id }}-{{ commandes[0].dateCreation|date('Ymd') }}</p>
            </div>
            <div class="status-badge" style="background: #d62b2b; color: white; padding: 0.5rem 1rem; border-radius: 4px;">
                {{ commandes[0].etat }}
            </div>
        </div>
        
        <!-- Order information -->
        <div class="order-info-grid">
            <div class="info-card">
                <h3>Date de commande</h3>
                <p>{{ commandes[0].dateCreation|date('d/m/Y') }}</p>
            </div>
            <div class="info-card">
                <h3>Client</h3>
                <p>{{ client.email }}</p>
            </div>
            <div class="info-card">
                <h3>Livraison prévue</h3>
                <p>{{ commandes[0].dateCreation|date_modify('+5 days')|date('d/m/Y') }}</p>
            </div>
        </div>
        
        <!-- Products table -->
        <div class="products-container">
            <div class="products-header">
                Articles commandés
            </div>
            <table class="products-table">
                <thead>
                    <tr>
                        <th style="width: 50%;">Produit</th>
                        <th style="width: 15%;">Prix unitaire</th>
                        <th style="width: 15%;">Quantité</th>
                        <th style="width: 20%;">Total</th>
                    </tr>
                </thead>
                <tbody>
                    {% for commande in commandes %}
                    {% if commande.equipement %}
                    <tr>
                        <td>
                            <div class="product-info">
                                <img src="{{ absolute_url(asset('uploads/images/' ~ commande.equipement.image)) }}" alt="{{ commande.equipement.nom }}" class="product-img">
                                <div>
                                    <div class="product-name">{{ commande.equipement.nom }}</div>
                                    <div class="product-sku">Ref: {{ commande.equipement.id }}</div>
                                </div>
                            </div>
                        </td>
                        <td>{{ commande.equipement.prix }} DT</td>
                        <td>{{ commande.quantite }}</td>
                        <td><strong>{{ commande.equipement.prix * commande.quantite }} DT</strong></td>
                    </tr>
                    {% endif %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Order summary -->
        <div class="order-summary">
            <h3 class="summary-title">Récapitulatif de commande</h3>
            <div class="summary-row">
                <span>Sous-total</span>
                <span>{{ total }} DT</span>
            </div>
            <div class="summary-row">
                <span>Livraison</span>
                <span>Gratuite</span>
            </div>
            <div class="summary-row">
                <span>Total TTC</span>
                <span>{{ total }} DT</span>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="invoice-footer">
            <p>Merci pour votre commande !</p>
            <p>Pour toute question, contactez-nous à contact@votresite.com</p>
            <p>Facture générée le {{ "now"|date('d/m/Y à H:i') }}</p>
        </div>
    </div>
</body>
</html>